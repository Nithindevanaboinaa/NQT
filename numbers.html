<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Progress Tracker</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container mt-4">
      <h1 class="text-center">TCS NQT Coding Sheet Tracker</h1>
      <nav class="nav justify-content-center my-3">
        <a class="nav-link active" href="#">Home</a>
        <a class="nav-link" href="array.html">Arrays</a>
        <a class="nav-link" href="string.html">Strings</a>
        <a class="nav-link" href="numbersystem.html">Number System</a>
        <a class="nav-link" href="numbers.html">Numbers</a>
        <a class="nav-link" href="sorting.html">Sorting</a>
      </nav>

      <h2 class="mt-4">Numbers Questions</h2>
      <div class="progress my-3">
        <div id="progressBar" class="progress-bar bg-danger" style="width: 0%;">
          0%
        </div>
      </div>
      <button class="btn btn-danger mb-3" id="resetProgress">
        Reset Progress
      </button>
      <table class="table table-bordered" id="taskTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Question</th>
            <th>Solution</th>
            <th>Done</th>
          </tr>
        </thead>
        <tbody>
          <!-- Questions will be dynamically loaded here -->
        </tbody>
      </table>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const progressBar = document.getElementById("progressBar");
        const resetButton = document.getElementById("resetProgress");
        const taskTable = document
          .getElementById("taskTable")
          .querySelector("tbody");
        let checkboxes = document.querySelectorAll(".doneCheckbox");

        // Load tasks from localStorage
        function loadTasks() {
          const storedQuestions = JSON.parse(localStorage.getItem("Numbers")) || [];
          taskTable.innerHTML = ""; // Clear existing rows

          storedQuestions.forEach((task, index) => {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>${task.question}</td>
              <td><a href="${task.url}" class="text-primary">Solution</a></td>
              <td><input type="checkbox" class="doneCheckbox" ${
                task.done ? "checked" : ""
              }></td>
            `;
            taskTable.appendChild(row);
          });

          refreshCheckboxes();
        }

        const totalQuestions = () => checkboxes.length;

        function updateProgress() {
          const completed = Array.from(checkboxes).filter(
            (checkbox) => checkbox.checked
          ).length;
          const percentage = Math.round((completed / totalQuestions()) * 100);
          progressBar.style.width = `${percentage}%`;
          progressBar.textContent = `${percentage}%`;
          progressBar.classList.toggle("bg-danger", percentage < 50);
          progressBar.classList.toggle("bg-success", percentage >= 50);
        }

        function refreshCheckboxes() {
          checkboxes = document.querySelectorAll(".doneCheckbox");
          checkboxes.forEach((checkbox, index) => {
            checkbox.removeEventListener("change", updateProgress);
            checkbox.addEventListener("change", () => {
              const storedQuestions =
                JSON.parse(localStorage.getItem("Numbers")) || [];
              storedQuestions[index].done = checkbox.checked;
              localStorage.setItem("Numbers", JSON.stringify(storedQuestions));
              updateProgress();
            });
          });
          updateProgress();
        }

        resetButton.addEventListener("click", () => {
          const storedQuestions = JSON.parse(localStorage.getItem("Numbers")) || [];
          storedQuestions.forEach((task) => (task.done = false));
          localStorage.setItem("Numbers", JSON.stringify(storedQuestions));
          loadTasks();
          updateProgress();
        });

        // Initial setup
        loadTasks();
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
